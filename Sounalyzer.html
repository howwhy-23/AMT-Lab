<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sounalyzer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Roboto:wght@400;500;700&family=Merriweather:wght@400;700&family=Orbitron:wght@400;500;600;700&family=Exo+2:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
     :root {
      --primary-dark: #1a1a2e;
      --secondary-dark: #16213e;
      --accent-blue: #4ecdc4;
      --accent-orange: #ff6b6b;
      --accent-purple: #5b86e5;
      --text-light: #e6e6e6;
      --panel-bg: rgba(22, 22, 70, 0.95);
      --card-bg: rgba(65, 65, 115, 0.8);
      --control-bg: rgba(15, 15, 35, 0.8);
      --gold-primary: #ffd700;
      --gold-secondary: #ffb347;
      --cyan-accent: #00ffff;
      --neon-pink: #ff10f0;
      --neon-blue: #00bfff;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Exo 2', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--primary-dark), var(--secondary-dark), #0a0a1a);
      color: var(--text-light);
      min-height: 100vh;
      padding: 20px;
      overflow-x: hidden;
      scrollbar-width: thin;
      scrollbar-color: var(--accent-blue) rgba(20,20,40,0.8);
      font-weight: 400;
      line-height: 1.6;
    }
    
    html {
      filter: brightness(140%);
    }

    ::-webkit-scrollbar {
      width: 10px;
      background-color: #151530;
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(to bottom, var(--accent-blue), #36d1dc);
      border-radius: 4px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    header {
      text-align: center;
      padding: 30px 0;
      margin-bottom: 30px;
      background: linear-gradient(90deg, 
        rgba(74, 74, 113, 0.9), 
        rgba(32, 136, 131, 0.9),
        rgba(91, 134, 229, 0.9));
      border-radius: 15px;
      box-shadow: 
        10px 10px 30px rgba(0, 0, 0, 0.5),
        inset 0 0 0 1px rgba(255, 255, 255, 0.15);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(78, 205, 196, 0.3);
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, 
        rgba(255, 107, 107, 0.1) 0%, 
        rgba(78, 205, 196, 0.1) 50%, 
        rgba(91, 134, 229, 0.1) 100%);
      z-index: 1;
    }
    
    header h1 {
      font-size: 3.5rem;
      margin-bottom: 15px;
      background: linear-gradient(90deg, var(--accent-orange), var(--accent-blue), var(--accent-purple), var(--neon-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      letter-spacing: 1px;
      position: relative;
      z-index: 2;
      font-weight: 800;
      font-family: 'Orbitron', sans-serif;
    }
    
    .subtitle {
      font-size: 1.4rem;
      background: linear-gradient(90deg, #c0c0ff, #a0f0f0, #c0c0ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      max-width: 700px;
      margin: 0 auto;
      line-height: 1.6;
      position: relative;
      z-index: 2;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      font-weight: 500;
    }
    
    .main-content {
      display: grid;
      grid-template-columns: 350px 1fr;
      gap: 30px;
    }
    
    .panel-section {
      padding: 20px;
      background: linear-gradient(145deg, var(--card-bg), rgba(55, 55, 95, 0.8));
      border-radius: 12px;
      box-shadow: 
        inset 0 0 10px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(78, 205, 196, 0.2);
      transition: all 0.3s ease;
    }
    
    .panel-section:hover {
      box-shadow: 
        inset 0 0 15px rgba(0, 0, 0, 0.4),
        0 0 0 1px rgba(78, 205, 196, 0.3);
      border: 1px solid rgba(78, 205, 196, 0.3);
      transform: translateY(-2px);
    }
    
    h2 {
      font-size: 1.7rem;
      margin-bottom: 20px;
      color: var(--accent-blue);
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: 'Orbitron', sans-serif;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(78, 205, 196, 0.5);
    }
    
    h2 i {
      font-size: 1.4rem;
    }
    
    .control-group {
      margin-bottom: 20px;
      position: relative;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #b0b0ff;
      text-shadow: 0 0 5px rgba(176, 176, 255, 0.5);
    }
    
    .input-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    input[type="range"], input[type="number"], input[type="color"], input[type="file"], input[type="checkbox"], select {
      width: 100%;
      padding: 0px;
      background: var(--control-bg);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 7px;
      color: white;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    input[type="range"]:hover, input[type="number"]:hover, 
    input[type="color"]:hover, input[type="file"]:hover,
    input[type="checkbox"]:hover, select:hover {
      border-color: var(--accent-blue);
      box-shadow: 0 0 8px rgba(78, 205, 196, 0.5);
    }
    
    /* Range Control */
    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 5px;
      background: var(--control-bg);
      border-radius: 4px;
      outline: none;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 22px;
      height: 22px;
      border-radius: 1    0%;
      background: var(--accent-blue);
      cursor: pointer;
      box-shadow: 0 0 10px rgba(78, 205, 196, 0.8);
      border: 2px solid white;
      margin-top: -9px;
      transform: scaleY(0.5); /* 50% scale */
      transform-origin: center; /* Origin at center */
    }
    
    input[type="range"]::-webkit-slider-runnable-track {
      width: 100%;
      height: 100%;
      background: linear-gradient(to right, var(--accent-blue), #36d1dc);
      border-radius: 4px;
    }
    
    .btn {
      display: inline-block;
      width: 100%;
      padding: 14px;
      background: linear-gradient(90deg, var(--accent-orange), #ff8e53);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 10px rgba(255, 107, 107, 0.3);
      position: relative;
      overflow: hidden;
      z-index: 1;
      font-family: 'Exo 2', sans-serif;
    }
    
    .btn:before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
      z-index: -1;
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 7px 20px rgba(255, 107, 107, 0.5);
    }
    
    .btn:hover:before {
      left: 100%;
    }
    
    .btn-secondary {
      background: linear-gradient(90deg, #36d1dc, var(--accent-purple));
      box-shadow: 0 4px 10px rgba(54, 209, 220, 0.3);
    }
    
    .btn-secondary:hover {
      box-shadow: 0 7px 20px rgba(54, 209, 220, 0.5);
    }
    
    .visualization-area {
      position: relative;
      background: rgba(10, 10, 25, 0.9);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.5),
        inset 0 0 0 1px rgba(255, 255, 255, 0.1);
      height: 700px;
      display: flex;
      flex-direction: column;
      border: 1px solid rgba(78, 205, 196, 0.3);
      aspect-ratio: 16/9;
    }
    
    #canvas-container {
      flex: 1;
      position: relative;
      overflow: hidden;
      border-top: #52748b 2px solid;
      border-left: #52748b 2px solid;
      border-right: #52748b 2px solid;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      border-top-left-radius: 14px;
      border-top-right-radius: 14px;
    }
    
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    /* Visualization Cards */
    .visualizations {
      display: flex;
      flex-direction: column;
      gap: 30px;
      height: 100%;
      position: absolute;
      width: 70%;
      left: 15px;
    }
    
    .visualization {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      height: 50%;
    }
    
    /* Visualization Labels */
    .visualization-label {
      font-size: 1.7rem;
      color: #e6e6e6;
      margin-bottom: 15px;
      text-align: center;
      font-weight: 600;
      letter-spacing: 1.2px;
      display: flex;
      align-items: center;
      gap: 15px;
      position: relative;
      padding: 0 20px;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(5deg, transparent, var(--accent-blue));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 8px rgba(78, 205, 196, 0.4);
    }
    
    .visualization-label::before,
    .visualization-label::after {
      content: '';
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);
      border-radius: 1px;
    }
    
    /* Canvas Containers */
    .canvas-container {
      position: relative;
      width: 100%;
      height: 200px;
      background: rgba(10, 11, 20, 0.6);
      border-radius: 15px;
      border: 1px solid rgba(78, 205, 196, 0.3);
      overflow: hidden;
      box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
      transition: transform 0.3s ease;
    }
    
    .canvas-container:hover {
      transform: scale(1.01);
    }
    
    /* Axis Labels */
    .axis-label {
      font-size: 1.15rem;
      color: #c0c0ff;
      margin-top: 12px;
      text-align: center;
      width: 100%;
      font-weight: 500;
      letter-spacing: 0.5px;
      opacity: 0.9;
      text-shadow: 0 0 5px rgba(192, 192, 255, 0.5);
    }
    
    /* Sensitivity Control */
    .sensitivity-control {
      width: 100%;
      margin-bottom: 10px;
      padding: 20px;
      background: var(--card-bg);
      border-radius: 15px;
      border: 1px solid var(--accent-blue);
      box-shadow: 0 0 15px rgba(78, 205, 196, 0.3);
      transition: all 0.3s ease;
    }
    
    .sensitivity-control:hover {
      box-shadow: 0 0 20px rgba(78, 205, 196, 0.4);
    }
    
    .sensitivity-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      color: #e6e6e6;
      font-size: 1.2rem;
      font-weight: 500;
    }
    
    .sensitivity-slider {
      width: 100%;
      height: 10px;
      appearance: none;
      -webkit-appearance: none;
      background: rgba(150, 125, 0, 0.3);
      border-radius: 5px;
      outline: none;
    }
    
    .sensitivity-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 22px;
      height: 22px;
      background: var(--accent-blue);
      cursor: pointer;
      box-shadow: 0 0 15px rgba(78, 205, 196, 0.9);
      border: 2px solid #332200;
      transition: transform 0.2s ease;
    }
    
    .sensitivity-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      background: #36d1dc;
    }
    
    /* Controls */
    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      width: 100%;
      margin-bottom: 10px;
    }

    .controls-section {
      width: 25%;
      position: absolute;
      right: 20px;
      top: 10px;
    }
    
    /* Metrics Cards */
    .metrics {
      display: flex;
      flex-direction: column;
      gap: 20px;
      width: 100%;
    }
    
    .metric {
      background: linear-gradient(145deg, var(--card-bg), rgba(55, 55, 95, 0.8));
      padding: 22px 20px;
      border-radius: 15px;
      text-align: center;
      border: 1px solid var(--accent-blue);
      box-shadow: 0 0 15px rgba(78, 205, 196, 0.3);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .metric:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 20px rgba(78, 205, 196, 0.4);
      background: rgba(80, 70, 0, 0.45);
    }
    
    .metric::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--accent-blue);
      box-shadow: 0 0 10px var(--accent-blue);
    }
    
    .metric-title {
      font-size: 1.2rem;
      color: #e6e6e6;
      margin-bottom: 10px;
      letter-spacing: 0.8px;
      font-weight: 500;
      text-shadow: 0 0 5px rgba(230, 230, 230, 0.5);
    }
    
    .metric-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent-blue);
      text-shadow: 0 0 12px rgba(78, 205, 196, 0.4);
      letter-spacing: 0.5px;
      font-family: 'Orbitron', sans-serif;
    }
    
    .metric-unit {
      font-size: 1.05rem;
      color: #e0e0e0;
      margin-left: 5px;
      opacity: 0.8;
    }
    
    /* Modal Styling */
    #modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right:0; bottom:0;
      background: rgba(0,0,0,0.85);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(8px);
    }
    
    #modal {
      background: linear-gradient(145deg, rgba(20, 20, 30, 0.98), rgba(15, 15, 25, 0.95));
      border-radius: 20px;
      padding: 35px;
      width: 90%;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
      border: 2px solid var(--accent-blue);
      position: relative;
      animation: modalAppear 0.5s ease;
    }
    
    @keyframes modalAppear {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    #modal h2 {
      margin-top: 0;
      margin-bottom: 25px;
      font-weight: 700;
      color: var(--accent-blue);
      font-size: 2rem;
      letter-spacing: 1.5px;
      font-family: 'Orbitron', sans-serif;
    }
    
    .time-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }
    
    .time-btn {
      background: rgba(70, 60, 0, 0.4);
      border: 1px solid var(--accent-blue);
      border-radius: 12px;
      padding: 16px;
      font-weight: 600;
      cursor: pointer;
      font-size: 1.15rem;
      transition: all 0.3s ease;
      color: white;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      font-family: 'Exo 2', sans-serif;
    }
    
    .time-btn:hover {
      background: rgba(100, 85, 0, 0.5);
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(78, 205, 196, 0.3);
    }
    
    #modal-close {
      margin-top: 25px;
      cursor: pointer;
      color: #e6e6e6;
      font-size: 1.1rem;
      user-select: none;
      transition: color 0.3s;
      font-weight: 500;
      letter-spacing: 0.5px;
    }
    
    #modal-close:hover {
      color: var(--accent-blue);
      text-shadow: 0 0 10px rgba(78, 205, 196, 0.4);
    }

    footer {
      text-align: center;
      margin-top: 50px;
      color: #e6e6e6;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .footer-highlight {
      color: var(--accent-blue);
      font-weight: 500;
      text-shadow: 0 0 5px rgba(78, 205, 196, 0.5);
    }

    /* Particles Background */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    
    .particle {
      position: absolute;
      background: rgba(78, 205, 196, 0.4);
      border-radius: 50%;
      pointer-events: none;
      animation: float 15s infinite linear;
    }
    
    @keyframes float {
      0% {
        transform: translateY(0) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) translateX(20vw);
        opacity: 0;
      }
    }
    
    /* Sound Indicator */
    .sound-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      background: rgba(25, 25, 35, 0.9);
      padding: 10px 20px;
      border-radius: 25px;
      border: 1px solid var(--accent-blue);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      z-index: 10;
      backdrop-filter: blur(5px);
      transition: all 0.3s ease;
    }
    
    .indicator-light {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background-color: #ff5252;
      box-shadow: 0 0 8px #ff5252;
      transition: all 0.3s ease;
    }
    
    .indicator-light.active {
      background-color: #00e676;
      box-shadow: 0 0 15px #00e676;
    }
    
    .indicator-text {
      font-size: 1rem;
      color: #e6e6e6;
      font-weight: 500;
    }
    
    /* Progress Bar */
    .progress-bar {
      width: 100%;
      height: 10px;
      background: rgba(70, 60, 0, 0.3);
      border-radius: 5px;
      margin-top: 25px;
      overflow: hidden;
      display: none;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.4);
      position: relative; 
      top: -30px;
    }
    
    .progress {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-orange), #ff8e53);
      width: 0%;
      transition: width 0.1s linear;
      box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
    }
    
    /* Responsive Design */
    @media (max-width: 1100px) {
      .main-content {
        grid-template-columns: 1fr;
      }
      
      .visualization-area {
        height: auto;
      }
    }
    
    @media (max-width: 768px) {
      header h1 {
        font-size: 2.5rem;
      }
      
      .subtitle {
        font-size: 1.1rem;
      }
      
      .visualization-label {
        font-size: 1.5rem;
      }
      
      .metric-value {
        font-size: 1.8rem;
      }
      
      .time-options {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 480px) {
      header {
        padding: 20px 15px;
      }
      
      header h1 {
        font-size: 2rem;
      }
      
      .visualization-label {
        font-size: 1.3rem;
      }
      
      .axis-label {
        font-size: 1rem;
      }
    }
    
    /* Glow Effects */
    .glow-effect {
      position: absolute;
      border-radius: 50%;
      filter: blur(20px);
      z-index: -1;
    }
    
    .glow-1 {
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(255, 107, 107, 0.2) 0%, transparent 70%);
      top: -100px;
      right: -100px;
    }
    
    .glow-2 {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(78, 205, 196, 0.15) 0%, transparent 70%);
      bottom: -150px;
      left: -100px;
    }
    
    .glow-3 {
      width: 250px;
      height: 250px;
      background: radial-gradient(circle, rgba(91, 134, 229, 0.15) 0%, transparent 70%);
      top: 40%;
      left: 20%;
    }

    .return-btn {
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: fixed;
      display: flex;
      z-index: 1000;
      background: linear-gradient(90deg, #e4a443, #bd7913);
      border-bottom-right-radius: 20px;
      border-top-right-radius: 5px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      font-size: 1.2rem;
      color: #fff !important;
      transform-origin: top;
      border: 0px solid rgba(2, 119, 189, 0.258);
      font-family: 'Exo 2', sans-serif;
      width: 150px;
      height: 50px;
      justify-content: center;
      align-items: center;
      top: 0px;
      left: 0px;
    }

    .return-btn:hover {
      box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
      transform: scaleY(110%);
    }

    /* New font styles */
    .tech-font {
      font-family: 'Orbitron', sans-serif;
      font-weight: 500;
    }
    
    .gradient-text {
      background: linear-gradient(90deg, var(--accent-orange), var(--accent-blue), var(--accent-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .subtle-glow {
      text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
    }

  </style>
</head>
<body>

  <!-- Particle background -->
  <div class="particles" id="particles"></div>

  <!-- Sound indicator -->
  <div class="sound-indicator" id="sound-indicator">
    <div class="indicator-light" id="indicator-light"></div>
    <div class="indicator-text">Microphone: <span id="mic-status">Idle</span></div>
  </div>
  
  <div class="container">
    <header>
      <h1>Audio + Spectrum = Sounalyzer</h1>
      <p class="subtitle">Real-time audio analysis: dB, hz frequency, waveform visualization, and acoustic metrics.</p>
    </header>

    <button class="return-btn" onclick="window.location.href='Switch_Interface.html'"><i class="fas fa-undo"></i></button>
    
    <div class="main-content">
      
      <!-- Visualization Area -->
      <div class="visualization-area">
        <div class="glow-effect glow-1"></div>
        <div class="glow-effect glow-2"></div>
        <div class="glow-effect glow-3"></div>
        
        <div class="card-content">
          <div class="visualizations">
            <!-- Waveform -->
            <div class="visualization">
              <div class="visualization-label">
                <span>Waveform (Time Domain)</span>
              </div>
              <div class="canvas-container">
                <canvas id="canvas-waveform"></canvas>
              </div>
              <div class="axis-label">Time (ms) <span style="letter-spacing: 3px;">0--------------------2--------------------4--------------------></span></div>
            </div>
            
            <!-- Spectrum -->
            <div class="visualization">
              <div class="visualization-label">
                <span>Frequency Spectrum</span>
              </div>
              <div class="canvas-container">
                <canvas id="canvas-spectrum" style="height: 220px; top: -20px;"></canvas>
              </div>
              <div class="axis-label">Low <span style="letter-spacing: 3px;">----------------------------------------------------------------></span> High (Hz)</div>
            </div>
          </div>
          
          <div class="controls-section">
            <!-- Sensitivity -->
            <div class="sensitivity-control">
              <div class="sensitivity-label">
                <span>Sensitivity:</span>
                <span id="sensitivity-value">Medium</span>
              </div>
              <input type="range" min="1" max="25" value="10" class="sensitivity-slider" id="sensitivity-slider">
            </div>
            
            <!-- Controls -->
            <div class="controls">
              <button id="start-btn" class="btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="position: relative; top: 2.5px; left: -5px;">
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                <span style="position: relative; top: -5px;">Start Analysis</span>
              </button>
            </div>
            
            <!-- Metrics -->
            <div class="metrics">
              <div class="metric">
                <div class="metric-title">Volume Level</div>
                <div class="metric-value"><span id="volume">-</span><span class="metric-unit">dB</span></div>
              </div>
              
              <div class="metric">
                <div class="metric-title">Dominant Frequency</div>
                <div class="metric-value"><span id="frequency">-</span><span class="metric-unit">Hz</span></div>
              </div>
              
              <div class="metric">
                <div class="metric-title">Peak Volume</div>
                <div class="metric-value"><span id="peak-volume">-</span><span class="metric-unit">dB</span></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Progress bar -->
        <div class="progress-bar" id="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
    </div>
    
    <footer>
      <span class="footer-highlight">Utilizing Web Audio API</span>
      <span style="color:white;">&nbsp;&nbsp;|&nbsp;&nbsp;</span>
      <span class="footer-highlight">For best results, use headphones and ensure a quiet environment</span>
      <p style="color: #9c9cff; font-style: italic; margin-top: 0px;">Sounalyzer.html &copy; 2025 Howwhy</p>
    </footer>
  </div>

  <!-- Duration Selection Modal -->
  <div id="modal-overlay">
    <div id="modal">
      <h2>Select Analysis Duration</h2>
      <p>Choose how long to capture and analyze audio data</p>
      
      <div class="time-options">
        <button class="time-btn" data-time="5">5 Seconds</button>
        <button class="time-btn" data-time="10">10 Seconds</button>
        <button class="time-btn" data-time="20">20 Seconds</button>
        <button class="time-btn" data-time="60">60 Seconds</button>
        <button class="time-btn" data-time="0">Live Mode</button>
      </div>
      
      <div id="modal-close">Cancel</div>
    </div>
  </div>

  <script>
    // Create particles
    function createParticles() {
      const container = document.getElementById('particles');
      const particleCount = 35;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Random properties
        const size = Math.random() * 5 + 1;
        const posX = Math.random() * window.innerWidth;
        const posY = Math.random() * window.innerHeight;
        const animationDuration = Math.random() * 15 + 10;
        const opacity = Math.random() * 0.4 + 0.1;
        const hue = Math.random() * 60 + 40; // Yellow to gold
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}px`;
        particle.style.top = `${posY}px`;
        particle.style.opacity = opacity;
        particle.style.animationDuration = `${animationDuration}s`;
        particle.style.background = `hsla(${hue}, 100%, 50%, ${opacity})`;
        
        container.appendChild(particle);
      }
    }
    
    const startBtn = document.getElementById('start-btn');
    const modalOverlay = document.getElementById('modal-overlay');
    const modalClose = document.getElementById('modal-close');
    const timeButtons = document.querySelectorAll('.time-btn');
    const canvasWaveform = document.getElementById('canvas-waveform');
    const canvasSpectrum = document.getElementById('canvas-spectrum');
    const volumeDisplay = document.getElementById('volume');
    const frequencyDisplay = document.getElementById('frequency');
    const peakVolumeDisplay = document.getElementById('peak-volume');
    const ctxWaveform = canvasWaveform.getContext('2d');
    const ctxSpectrum = canvasSpectrum.getContext('2d');
    const sensitivitySlider = document.getElementById('sensitivity-slider');
    const sensitivityValue = document.getElementById('sensitivity-value');
    const micStatus = document.getElementById('mic-status');
    const indicatorLight = document.getElementById('indicator-light');
    const progressBar = document.getElementById('progress-bar');
    const progress = document.getElementById('progress');

    let audioCtx, analyser, microphone;
    let dataArray, freqArray;
    let animationId;
    let testDuration = 0;
    let testStartTime;
    let volumeSamples = [];
    let freqSamples = [];
    let maxVolume = -Infinity;
    let isAnalyzing = false;
    let sensitivity = 10; // Default sensitivity level (1-25)

    // Sensitivity labels
    const sensitivityLabels = {
      1: 'Very Low',
      2: 'Very Low',
      3: 'Low',
      4: 'Low',
      5: 'Low',
      6: 'Medium',
      7: 'Medium',
      8: 'Medium',
      9: 'Medium',
      10: 'Medium',
      11: 'High',
      12: 'High',
      13: 'High',
      14: 'High',
      15: 'High',
      16: 'Very High',
      17: 'Very High',
      18: 'Very High',
      19: 'Very High',
      20: 'Very High',
      21: 'Extreme',
      22: 'Extreme',
      23: 'Extreme',
      24: 'Extreme',
      25: 'Extreme'
    };

    // Initialize canvas resolution
    function initCanvas() {
      const dpr = window.devicePixelRatio || 1;
      
      // Set canvas dimensions
      canvasWaveform.width = canvasWaveform.parentElement.clientWidth * dpr;
      canvasWaveform.height = canvasWaveform.parentElement.clientHeight * dpr;
      
      canvasSpectrum.width = canvasSpectrum.parentElement.clientWidth * dpr;
      canvasSpectrum.height = canvasSpectrum.parentElement.clientHeight * dpr;
      
      // Scale drawing contexts
      ctxWaveform.scale(dpr, dpr);
      ctxSpectrum.scale(dpr, dpr);
    }

    // Set up event listeners
    function setupEventListeners() {
      startBtn.onclick = () => {
        if (isAnalyzing) {
          stopAnalysis();
          return;
        }
        modalOverlay.style.display = 'flex';
      };

      modalClose.onclick = () => {
        modalOverlay.style.display = 'none';
      };

      timeButtons.forEach(btn => {
        btn.onclick = () => {
          testDuration = parseInt(btn.getAttribute('data-time'));
          modalOverlay.style.display = 'none';
          startAnalysis();
        };
      });
      
      sensitivitySlider.addEventListener('input', () => {
        sensitivity = parseInt(sensitivitySlider.value);
        sensitivityValue.textContent = sensitivityLabels[sensitivity];
      });
    }

    // Start audio analysis
    function startAnalysis() {
      navigator.mediaDevices.getUserMedia({
        audio: {
          echoCancellation: false,
          noiseSuppression: false,
          autoGainControl: false,
        }
      }).then(stream => {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioCtx.createAnalyser();
        analyser.fftSize = 2048;
        dataArray = new Uint8Array(analyser.fftSize);
        freqArray = new Uint8Array(analyser.frequencyBinCount);

        microphone = audioCtx.createMediaStreamSource(stream);
        microphone.connect(analyser);

        startBtn.textContent = 'Stop Analysis';
        startBtn.classList.add('btn-stop');
        testStartTime = performance.now();
        volumeSamples = [];
        freqSamples = [];
        maxVolume = -Infinity;
        isAnalyzing = true;
        micStatus.textContent = 'Active';
        indicatorLight.classList.add('active');
        
        // Show progress bar if timed analysis
        if (testDuration > 0) {
          progressBar.style.display = 'block';
          progress.style.width = '0%';
        }
        
        // Initialize visualizations
        drawWaveform(new Uint8Array(analyser.fftSize).fill(128));
        drawSpectrum(new Uint8Array(analyser.frequencyBinCount).fill(0));
        
        // Start the analysis loop
        draw();
      }).catch(err => {
        alert('Microphone access error: ' + err.message);
        stopAnalysis();
      });
    }

    // Stop audio analysis
    function stopAnalysis() {
      cancelAnimationFrame(animationId);
      if (microphone?.mediaStream) {
        microphone.mediaStream.getTracks().forEach(track => track.stop());
      }
      if (audioCtx) audioCtx.close();
      audioCtx = null;
      startBtn.textContent = 'Start Analysis';
      startBtn.classList.remove('btn-stop');
      isAnalyzing = false;
      micStatus.textContent = 'Idle';
      indicatorLight.classList.remove('active');
      progressBar.style.display = 'none';
      
      // If we were in a timed analysis, show summary
      if (testDuration > 0 && volumeSamples.length > 0) {
        showSummary(maxVolume);
      }
    }

    // Main analysis loop
    function draw() {
      if (!audioCtx) return;
      animationId = requestAnimationFrame(draw);

      // Get current audio data
      analyser.getByteTimeDomainData(dataArray);
      analyser.getByteFrequencyData(freqArray);

      // Update visualizations
      drawWaveform(dataArray);
      drawSpectrum(freqArray);

      // Calculate metrics
      const volume = getVolumeTimeDomain(dataArray);
      const freq = getDominantFreq(freqArray, audioCtx.sampleRate, analyser.fftSize);

      // Update max volume
      if (volume > maxVolume) maxVolume = volume;
      peakVolumeDisplay.textContent = maxVolume.toFixed(1);

      // Update displays
      volumeDisplay.textContent = volume.toFixed(1);
      frequencyDisplay.textContent = freq.toFixed(1);

      // Collect samples for timed analysis
      if (testDuration > 0) {
        volumeSamples.push(volume);
        freqSamples.push(freq);
        
        // Update progress bar
        const elapsed = (performance.now() - testStartTime) / 1000;
        const progressPercent = Math.min(100, (elapsed / testDuration) * 100);
        progress.style.width = `${progressPercent}%`;
        
        // Check if test duration has been reached
        if (elapsed > testDuration) {
          stopAnalysis();
        }
      }
    }

    // Draw waveform visualization
    function drawWaveform(data) {
      const w = canvasWaveform.parentElement.clientWidth;
      const h = canvasWaveform.parentElement.clientHeight;
      
      // Clear canvas
      ctxWaveform.clearRect(0, 0, w, h);
      
      // Draw background
      ctxWaveform.fillStyle = 'rgba(8, 8, 16, 0.4)';
      ctxWaveform.fillRect(0, 0, w, h);
      
      // Draw grid
      ctxWaveform.strokeStyle = 'rgba(120, 120, 120, 0.2)';
      ctxWaveform.lineWidth = 1;
      
      // Horizontal grid lines
      for (let i = 1; i < 3; i++) {
        const y = (h / 3) * i;
        ctxWaveform.beginPath();
        ctxWaveform.moveTo(0, y);
        ctxWaveform.lineTo(w, y);
        ctxWaveform.stroke();
      }
      
      // Vertical grid lines
      for (let i = 1; i < 6; i++) {
        const x = (w / 6) * i;
        ctxWaveform.beginPath();
        ctxWaveform.moveTo(x, 0);
        ctxWaveform.lineTo(x, h);
        ctxWaveform.stroke();
      }
      
      // Draw waveform - GOLD color
      ctxWaveform.strokeStyle = '#ffd700';
      ctxWaveform.lineWidth = 3;
      ctxWaveform.lineCap = 'round';
      ctxWaveform.lineJoin = 'round';
      ctxWaveform.beginPath();
      const dx = w / data.length;
      let x = 0;
      
      for (let i = 0; i < data.length; i++) {
        // Center waveform vertically
        const y = h/2 + (data[i] - 128) * (h/2) / 128;
        
        i === 0 ? ctxWaveform.moveTo(x, y) : ctxWaveform.lineTo(x, y);
        x += dx;
      }
      
      ctxWaveform.stroke();
    }

    // Draw frequency spectrum - IMPROVED FOR QUIET ENVIRONMENTS
    function drawSpectrum(data) {
      const w = canvasSpectrum.parentElement.clientWidth;
      const h = canvasSpectrum.parentElement.clientHeight;
      
      // Clear canvas
      ctxSpectrum.clearRect(0, 0, w, h);
      
      // Draw background
      ctxSpectrum.fillStyle = 'rgba(8, 8, 16, 0.4)';
      ctxSpectrum.fillRect(0, 0, w, h);
      
      // Draw frequency bars with sensitivity adjustment
      const barW = (w / data.length) * 2;
      let x = 0;
      
      // Sensitivity multiplier (1-25 scale mapped to 1-5x amplification)
      const sensitivityMultiplier = 1 + (sensitivity * 0.16);
      
      for (let i = 0; i < data.length; i++) {
        // Apply sensitivity amplification to quiet signals
        let amplifiedValue = data[i] * sensitivityMultiplier;
        if (amplifiedValue > 255) amplifiedValue = 255;
        
        // Apply logarithmic scaling to make quiet signals more visible
        const normalizedValue = amplifiedValue / 255;
        const logValue = Math.log(1 + normalizedValue * 9) / Math.log(10); // 0-1 range
        const barH = logValue * h * 0.9;
        
        // Create gradient for bars - GOLD to CYAN
        const gradient = ctxSpectrum.createLinearGradient(0, h - barH, 0, h);
        gradient.addColorStop(0, '#ffd700');
        gradient.addColorStop(0.7, '#00ffff');
        
        ctxSpectrum.fillStyle = gradient;
        ctxSpectrum.fillRect(x, h - barH, barW, barH);
        
        // Add bar highlights - CYAN
        ctxSpectrum.fillStyle = 'rgba(0, 255, 255, 0.4)';
        ctxSpectrum.fillRect(x, h - barH, barW, 3);
        
        x += barW + 1;
      }
    }

    // Calculate volume in dB
    function getVolumeTimeDomain(data) {
      let sum = 0;
      for (let i = 0; i < data.length; i++) {
        const val = (data[i] - 128) / 128;
        sum += val * val;
      }
      const rms = Math.sqrt(sum / data.length);
      const safeRms = rms < 0.00001 ? 0.00001 : rms;
      
      // Calculate dB with more natural curve
      let dB = 40 * Math.log10(safeRms) + 100;
      
      // Clamp between 0-120 dB
      if (dB < 0) dB = 0;
      if (dB > 120) dB = 120;
      
      return dB;
    }

    // Identify dominant frequency
    function getDominantFreq(data, sampleRate, fftSize) {
      let max = -Infinity, index = 0;
      for (let i = 0; i < data.length; i++) {
        if (data[i] > max) {
          max = data[i];
          index = i;
        }
      }
      return max > 10 ? index * sampleRate / fftSize : 0;
    }

    // Classify sound type based on frequency
    function classifySound(frequency) {
      if (frequency < 85) return "Sub-bass";
      if (frequency < 250) return "Bass";
      if (frequency < 2000) return "Midrange";
      if (frequency < 4000) return "Upper Midrange";
      if (frequency < 6000) return "Presence";
      return "Brilliance";
    }

    // Generate analysis summary
    function showSummary(maxVol) {
      const filteredFreqSamples = freqSamples.filter(f => f >= 20);
      const avgVol = volumeSamples.length
        ? volumeSamples.reduce((a, b) => a + b, 0) / volumeSamples.length
        : 0;
      const avgFreq = filteredFreqSamples.length
        ? filteredFreqSamples.reduce((a, b) => a + b, 0) / filteredFreqSamples.length
        : 0;
      const maxFreq = Math.max(...freqSamples);
      const soundType = classifySound(avgFreq);

      showSummaryHTML(avgVol, avgFreq, maxFreq, soundType, maxVol);
    }

    // Display summary report
    function showSummaryHTML(avgVol, avgFreq, maxFreq, soundType, maxVol) {
      const resultBox = document.createElement('div');
      resultBox.innerHTML = `
        <div style="
          position: fixed;
          top: 2.5%;
          left: 25%;
          background: linear-gradient(145deg, rgba(25, 25, 40, 0.98), rgba(20, 20, 35, 0.95));
          border-radius: 20px;
          padding: 15px;
          box-shadow: 0 25px 60px rgba(0,0,0,0.6);
          z-index: 10000;
          text-align: center;
          width: 50%;
          max-width: 600px;
          font-family: 'Roboto', sans-serif;
          border: 2px solid rgba(255, 215, 0, 0.5);
          color: #ffffff;
          backdrop-filter: blur(10px);
        ">
          <h2 style="margin-top: 0; margin-bottom: 25px; 
            background: linear-gradient(135deg, var(--gold-primary), var(--cyan-accent));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.2rem;
            font-weight: 700;
          ">Analysis Summary</h2>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; margin: 30px 0;">
            <div style="background: linear-gradient(135deg, rgba(70, 60, 0, 0.5), rgba(50, 40, 0, 0.5)); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 215, 0, 0.3);">
              <div style="color: #d4af37; margin-bottom: 10px; font-size: 1.2rem;">Average Volume</div>
              <div style="font-size: 2.2rem; font-weight: 700; color: #ffd700;">${avgVol.toFixed(1)}<span style="font-size: 1.1rem; color: #c0c0c0;"> dB</span></div>
            </div>
            
            <div style="background: linear-gradient(135deg, rgba(70, 60, 0, 0.5), rgba(50, 40, 0, 0.5)); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 215, 0, 0.3);">
              <div style="color: #d4af37; margin-bottom: 10px; font-size: 1.2rem;">Average Frequency</div>
              <div style="font-size: 2.2rem; font-weight: 700; color: #ffd700;">${avgFreq.toFixed(1)}<span style="font-size: 1.1rem; color: #c0c0c0;"> Hz</span></div>
            </div>
            
            <div style="background: linear-gradient(135deg, rgba(70, 60, 0, 0.5), rgba(50, 40, 0, 0.5)); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 215, 0, 0.3);">
              <div style="color: #d4af37; margin-bottom: 10px; font-size: 1.2rem;">Peak Frequency</div>
              <div style="font-size: 2.2rem; font-weight: 700; color: #ffd700;">${maxFreq.toFixed(1)}<span style="font-size: 1.1rem; color: #c0c0c0;"> Hz</span></div>
            </div>
            
            <div style="background: linear-gradient(135deg, rgba(70, 60, 0, 0.5), rgba(50, 40, 0, 0.5)); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 215, 0, 0.3);">
              <div style="color: #d4af37; margin-bottom: 10px; font-size: 1.2rem;">Sound Classification</div>
              <div style="font-size: 2.2rem; font-weight: 700; color: #ffd700;">${soundType}</div>
            </div>
          </div>
          
          <button style="
            margin-top: 20px;
            padding: 15px 35px;
            font-weight: bold;
            background: #ffd700;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            color: #332200;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
            font-family: 'Roboto', sans-serif;
            font-weight: 700;
            letter-spacing: 1px;
          " onclick="this.parentElement.parentElement.remove()">Close Report</button>
        </div>
      `;
      document.body.appendChild(resultBox);
    }

    // Initialize the application
    function init() {
      initCanvas();
      setupEventListeners();
      createParticles();
      
      // Initial visualizations
      ctxWaveform.clearRect(0, 0, canvasWaveform.width, canvasWaveform.height);
      ctxSpectrum.clearRect(0, 0, canvasSpectrum.width, canvasSpectrum.height);
      
      // Draw initial placeholder
      drawWaveform(new Uint8Array(2048).fill(128));
      drawSpectrum(new Uint8Array(1024).fill(0));
      
      // Set initial sensitivity value
      sensitivityValue.textContent = sensitivityLabels[sensitivity];
    }

    // Start when page loads
    window.addEventListener('DOMContentLoaded', init);
    window.addEventListener('resize', initCanvas);
  </script>
</body>
</html>
